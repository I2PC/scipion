{% extends 'showj_base.html' %} 
		
{% block head %}
	<script type="text/javascript">
	$(document).ready(function(){
		colsRowsEvents()
		imageEvents()
	});

	//Show enabled/disabled image and title on hover
	function imageEvents(){
		$(".img_container").hover(
			function(){
					if (!$(this).find(".enabledGallery").hasClass("selected")){
						$(this).find(".enabledGallery").fadeIn('slow')
					}
					/* $(this).find(".imageTitle").slideToggle('slow') */
				},
			function(){
					if (!$(this).find(".enabledGallery").hasClass("selected")){
						$(this).find(".enabledGallery").fadeOut('slow')
					}
					/* $(this).find(".imageTitle").slideToggle('slow') */
				})
	}
	
	//Change gallery layout when cols and rows textfield change
	function colsRowsEvents(){
		$("#id_cols, #id_rows").click(function(){
			updateGalleryLayout($("#id_cols").val(),$("#id_rows").val(), $(this).attr("id"))
		});
		
		$("#id_cols, #id_rows").change(function(){
			updateGalleryLayout($("#id_cols").val(),$("#id_rows").val(), $(this).attr("id"))
		});
	}
	
	function updateGalleryLayout(cols, rows, setElement){
		recalculateColsRows(cols,rows, setElement)
		updateMainContainerDim(cols)
	}
	
	function recalculateColsRows(cols, rows, setElement){
		if (setElement == "id_cols"){
			$("#id_rows").val(Math.ceil($(".img_container").length/cols))
		}
		else{
			$("#id_cols").val(Math.ceil($(".img_container").length/rows))
		}
	}
	function updateMainContainerDim(colVal){
		imgContainerWidth =$(".img_container").width() + (parseInt($(".img_container").css("margin-right")) * 2)
		sectionWidth = colVal * (imgContainerWidth + 10)
		$("section").width(sectionWidth)
	}
	function valueChange(element){
		$(element).toggleClass("selected")
		element_value="false"
		if ($(element).hasClass("selected")){
			element_value="true"
		}
		
		saveShowjTable($(element).attr("id"), element_value)
	}
	</script>
{% endblock %}

{% block content_menu %}
{% endblock %}

{% block content_view %}	
		{% for obj in metadata.objects %}
			{% for value in obj.values %}
				{% if value.typeOfColumn == "image" and value.label == form.metadataComboBox.value %}
					<div class="img_container">
						<div class="img_inner_container">
							<img class="tableImages" title="{{value.strValue}}" src="/get_image/?image={{value.imgValue}}"/>
							<img class="enabledGallery" src="/resources/showj/enabled_gallery.png" id="{{value.label}}___{{forloop.parentloop.counter0}}" onclick="valueChange(this);"/>
						</div>
						<div class="imageTitle">{{value.strValue}}</div>
						<div id="column_label">{{forloop.parentloop.counter}}</div> 
					</div> 
				{% endif %}
			{% endfor %}
		{% endfor %}	
			
{% endblock %}
